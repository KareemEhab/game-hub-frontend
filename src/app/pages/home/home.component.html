<div
  class="flex flex-row min-h-[calc(100vh-4rem)] md:min-h-screen overflow-y-hidden pt-16 md:pt-0"
>
  <!-- Sidebar - Hidden on mobile/tablet unless showSidebar is true -->
  <app-side-bar
    [isLoading]="genresLoading"
    [genres]="genres"
    [selectedGenre]="selectedGenre"
    (genreSelected)="onGenreSelected($event)"
  ></app-side-bar>
  <!-- Main Content -->
  <div
    class="w-full p-4 md:p-6 space-y-6 bg-gray-900 text-gray-100 min-h-screen"
  >
    <!-- Header Section -->
    <div class="text-center sm:text-left space-y-2">
      <h1
        class="text-5xl md:text-7xl font-bold text-white bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text"
      >
        {{ getGenreName(selectedGenre) || "Buy" }} Games
      </h1>
      <p class="text-sm md:text-base text-gray-400">
        Based on player counts and release date
      </p>
    </div>

    <!-- Filters Section -->
    <div
      class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-2 gap-3 md:gap-4"
    >
      <div class="sm:col-span-2 md:col-span-1 lg:col-span-1">
        <label
          for="orderSelect"
          class="block mb-1 md:mb-2 text-sm md:text-base font-medium text-gray-300"
        >
          <span class="flex items-center gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                fill-rule="evenodd"
                d="M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z"
                clip-rule="evenodd"
              />
            </svg>
            Order by:
          </span>
        </label>
        <select
          id="orderSelect"
          [(ngModel)]="orderValue"
          (change)="onOrderChange($event)"
          class="w-full text-sm md:text-base border border-gray-700 bg-gray-800 text-gray-200 rounded-lg p-2 md:p-3 focus:outline-none focus:ring-2 focus:ring-blue-400 hover:border-blue-400 transition-colors"
        >
          <option value="Relevance">Relevance</option>
          <option value="Name">Name</option>
          <option value="Release date">Release date</option>
          <option value="Popularity">Popularity</option>
          <option value="Average rating">Average rating</option>
        </select>
      </div>

      <div class="sm:col-span-2 md:col-span-1 lg:col-span-1">
        <label
          for="platformSelect"
          class="block mb-1 md:mb-2 text-sm md:text-base font-medium text-gray-300"
        >
          <span class="flex items-center gap-2">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-4 w-4"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                fill-rule="evenodd"
                d="M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z"
                clip-rule="evenodd"
              />
            </svg>
            Platform:
          </span>
        </label>
        <select
          id="platformSelect"
          (change)="onPlatformChange($event)"
          class="w-full text-sm md:text-base border border-gray-700 bg-gray-800 text-gray-200 rounded-lg p-2 md:p-3 focus:outline-none focus:ring-2 focus:ring-blue-400 hover:border-blue-400 transition-colors"
        >
          <option disabled selected>Platforms</option>
          <option value="PC">PC</option>
          <option value="Playstation">Playstation</option>
          <option value="Xbox">Xbox</option>
          <option value="Android">Android</option>
          <option value="Linux">Linux</option>
          <option value="Nintendo">Nintendo</option>
        </select>
      </div>
    </div>

    <!-- Game Card Container -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
      @for(item of list; track item.rawgId) {
      <div
        class="group relative transform transition-all duration-300 hover:scale-[1.02] hover:z-20"
      >
        <!-- Main Card Content -->
        <div
          class="h-full rounded-xl md:rounded-2xl group-hover:rounded-b-none p-4 bg-gray-800 transition-all duration-300 hover:shadow-xl hover:shadow-blue-900/10 relative"
        >
          <!-- Game Image with Gradient Overlay -->
          <div class="relative overflow-hidden rounded-lg aspect-video mb-4">
            <img
              [src]="
                item.backgroundImage ||
                'https://via.placeholder.com/400x225?text=No+Image+Available'
              "
              alt="Game image"
              class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
              onerror="this.src='https://via.placeholder.com/400x225?text=No+Image+Available'"
            />
            <div
              class="absolute inset-0 bg-gradient-to-t from-gray-900/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"
            ></div>
          </div>

          <!-- Game Info -->
          <div class="text-center">
            <p
              (click)="goToGameDetails(item.slug)"
              class="cursor-pointer text-lg md:text-xl font-bold text-white group-hover:text-blue-400 transition-colors line-clamp-2"
            >
              {{ item.name }}
            </p>
            <div class="flex justify-center mt-3">
              <button
                (click)="goToGameDetails(item.slug)"
                class="cursor-pointer group/btn relative overflow-hidden px-5 py-2 bg-blue-500 text-white rounded-full text-sm font-medium transition-all duration-300 shadow-md hover:shadow-lg hover:shadow-blue-500/30 transform hover:-translate-y-1 flex items-center gap-2"
              >
                <!-- Hover background effect -->
                <span
                  class="absolute inset-0 w-full h-full bg-blue-600 opacity-0 group-hover/btn:opacity-100 transition-opacity duration-500"
                ></span>

                <!-- Icon with animation -->
                <span
                  class="relative flex items-center justify-center w-5 h-5 bg-white/20 rounded-full transform group-hover/btn:rotate-12 transition-all duration-300"
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="h-3 w-3"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M14 5l7 7m0 0l-7 7m7-7H3"
                    />
                  </svg>
                </span>

                <!-- Text with relative positioning -->
                <span class="relative font-medium">Show details</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Expanding Details Panel -->
        <div
          class="absolute left-0 right-0 top-[calc(100%-1px)] bg-gray-800 rounded-b-xl md:rounded-b-2xl p-4 shadow-lg z-10 opacity-0 max-h-0 overflow-hidden group-hover:opacity-100 group-hover:max-h-[300px] transition-all duration-300 ease-in-out group-hover:shadow-xl group-hover:shadow-blue-900/10"
        >
          <div class="space-y-3 text-sm">
            <!-- Details content remains the same -->
            <div class="flex justify-between items-center">
              <span class="text-gray-400 flex items-center gap-1">
                <svg
                  class="h-4 w-4"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                  />
                </svg>
                Release:
              </span>
              <span class="font-medium">{{ item.released | date }}</span>
            </div>

            <div class="flex justify-between items-center">
              <span class="text-gray-400 flex items-center gap-1">
                <svg
                  class="h-4 w-4"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"
                  />
                </svg>
                Genres:
              </span>
              <span>
                {{item.tags?.[0]?.name || 'N/A'}},
                {{item.tags?.[item.tags.length - 1]?.name || 'N/A'}}
              </span>
            </div>

            <div class="flex justify-between items-center">
              <span class="text-gray-400 flex items-center gap-1">
                <svg
                  class="h-4 w-4"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"
                  />
                </svg>
                Chart:
              </span>
              <span class="font-medium"
                >#{{ item.ratingTop }} Top
                {{ item.released | date : "Y" }}</span
              >
            </div>

            <button
              class="hover:text-blue-500 cursor-pointer w-full mt-4 px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2"
            >
              <svg
                class="h-4 w-4"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                />
              </svg>
              Show more like this
            </button>
          </div>
        </div>
      </div>
      }

      <!-- Inline Skeleton Loader -->
      @if(isLoading) { @for(item of skeletonArray; track $index) {
      <div
        class="animate-pulse rounded-xl border border-gray-700 p-4 bg-gray-800/50"
      >
        <div class="aspect-video w-full rounded-lg bg-gray-700 mb-4"></div>
        <div class="h-5 w-3/4 rounded bg-gray-700 mb-3"></div>
        <div class="h-4 w-1/2 rounded bg-gray-700"></div>
        <div class="mt-4 flex justify-between">
          <div class="h-3 w-16 rounded bg-gray-700"></div>
          <div class="h-3 w-16 rounded bg-gray-700"></div>
        </div>
      </div>
      } }
    </div>

    <!-- Full Page Spinner Loader -->
    <div
      *ngIf="isLoading && list.length === 0"
      class="flex justify-center items-center py-12"
    >
      <div class="flex flex-col items-center gap-3">
        <div
          class="animate-spin rounded-full h-10 w-10 border-4 border-blue-500 border-t-transparent"
        ></div>
        <p class="text-gray-400 text-sm">Loading games...</p>
      </div>
    </div>
  </div>
</div>
